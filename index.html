<!DOCTYPE html>
<html>
<head>
  <title>Dental Portal Subscription</title>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>
  <h2>Subscribe to Dental Portal</h2>
  <button onclick="startSubscription()">Subscribe Now</button>

  <script>
    async function startSubscription() {
      try {
        const res = await fetch('http://localhost:3000/create-subscription', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          }
        });

        const data = await res.json();
        if (!data.subscriptionId) throw new Error('No subscription ID received');

        const razorpayOptions = {
          key: 'your_razorpay_key_id',
          subscription_id: data.subscriptionId,
          name: 'Dental Portal',
          description: 'Monthly Subscription',
          handler: function (response) {
            alert('Payment Successful! Razorpay ID: ' + response.razorpay_payment_id);
          },
          prefill: {
            name: 'John Doe',
            email: 'john@example.com',
            contact: '9999999999'
          },
          theme: {
            color: '#3399cc'
          }
        };

        const rzp = new Razorpay(razorpayOptions);
        rzp.open();
      } catch (err) {
        console.error('Subscription error:', err);
        alert('Failed to initiate subscription');
      }
    }
  </script>
</body>
</html>
